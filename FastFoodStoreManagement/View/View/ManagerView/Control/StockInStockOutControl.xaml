<UserControl x:Class="View.ManagerView.Control.StockInStockOutControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:View.ManagerView.Control"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" Background="Orange">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Dòng chứa 2 ô DatePicker -->
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="330"/>
            <!-- Nút Create -->
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Thêm 2 ô chọn ngày ở hàng 1 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="10" >
            <StackPanel Orientation="Vertical" Margin="0,0,200,0">
                <TextBlock Text="From Date:" FontWeight="Bold" Margin="0,0,0,5" HorizontalAlignment="Center"/>
                <DatePicker Name="FromDatePicker" Width="150" HorizontalAlignment="Center" SelectedDateChanged="DatePicker_SelectedDateChanged"/>
            </StackPanel>
            <StackPanel Orientation="Vertical" Margin="0,0,30,0" >
                <TextBlock Text="To Date:" FontWeight="Bold" Margin="0,0,0,5" HorizontalAlignment="Center"/>
                <DatePicker Name="ToDatePicker" Width="150" HorizontalAlignment="Center" SelectedDateChanged="DatePicker_SelectedDateChanged"/>
            </StackPanel>

            <Button Content="Clear" Width="70" Height="30" VerticalAlignment="Bottom" Click="ClearDateFilters_Click" />
        </StackPanel>

        <!-- ListView ở hàng 2 -->
        <ListView x:Name="LogDataGrid" Grid.Row="2" Margin="10"
          BorderThickness="0"
          ScrollViewer.VerticalScrollBarVisibility="Auto"
          ScrollViewer.HorizontalScrollBarVisibility="Auto">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Log ID" Width="80" DisplayMemberBinding="{Binding LogId}" />

                    <GridViewColumn Header="Log Type" Width="100">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <DockPanel LastChildFill="True" HorizontalAlignment="Stretch">
                                    <TextBlock Text="{Binding LogType}"
                                               HorizontalAlignment="Center"
                                               TextAlignment="Center"
                                               Width="100" />
                                </DockPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>


                    <GridViewColumn Header="Change Qty" Width="Auto">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <DockPanel LastChildFill="True" HorizontalAlignment="Stretch">
                                    <TextBlock Text="{Binding ChangeQty}"
                                               HorizontalAlignment="Center"
                                               TextAlignment="Center"
                                               Width="100" />
                                </DockPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn Header="Unit" Width="50">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <DockPanel LastChildFill="True" HorizontalAlignment="Stretch">
                                    <TextBlock Text="{Binding Unit}"
                                               HorizontalAlignment="Center"
                                               TextAlignment="Center"
                                               Width="100" />   
                                </DockPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn Header="Note" Width="Auto" DisplayMemberBinding="{Binding Note}" />

                    <GridViewColumn Header="Created At" Width="Auto">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <DockPanel LastChildFill="True" HorizontalAlignment="Stretch">
                                    <TextBlock Text="{Binding CreatedAt, StringFormat=dd/MM/yyyy HH:mm:ss}"
                                               HorizontalAlignment="Center"
                                               TextAlignment="Center"
                                               Width="120" />
                                </DockPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn Header="User" Width="Auto">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding UserFullName}"
                                           Padding="10,0,0,0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn Header="Material" Width="Auto">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding MaterialName}"
                                           Padding="5,0,0,0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn Header="Supplier" Width="Auto">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding SupplierName}"
                                           Padding="5,0,0,0"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                </GridView>
            </ListView.View>
        </ListView>
        
        <!-- Create -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Left" Margin="10">
            <Button Content="Create" Width="70" Height="35" Click="OpenPopup_Click"/>
        </StackPanel>

        <!-- Popup -->
        <Popup x:Name="CreatePopup"
               IsOpen="False"
               StaysOpen="False"
               Placement="Center"
               AllowsTransparency="True"
               PopupAnimation="Fade">
                <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="20" CornerRadius="10" Width="400">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Form -->
                        <Grid Margin="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>


                            <TextBlock Text="Material:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                            <ComboBox x:Name="MaterialComboBox" Grid.Row="1" Grid.Column="1" Width="200" Margin="0,5"
                                      DisplayMemberPath="Name"
                                      SelectedValuePath="MaterialId"/>  

                        <TextBlock Text="Change Qty:" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                            <TextBox x:Name="ChangeQtyTextBox" Grid.Row="2" Grid.Column="1" Width="200" Margin="0,5"/>

                            <TextBlock Text="Log Type:" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                            <ComboBox x:Name="LogTypeComboBox"
                                      Grid.Row="3" Grid.Column="1" Width="200" Margin="0,5"
                                      SelectionChanged="LogTypeComboBox_SelectionChanged">
                                <ComboBoxItem Content="StockIn" />
                                <ComboBoxItem Content="StockOut" />
                            </ComboBox>
                            
                            <TextBlock Text="Unit:" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                            <ComboBox x:Name="UnitTextBox" Grid.Row="4" Grid.Column="1" Width="200" Margin="0,5">
                                <ComboBoxItem Content="Cái" />
                                <ComboBoxItem Content="Kg" />
                                <ComboBoxItem Content="Lít"/>
                            </ComboBox>

                            <TextBlock Text="Note:" Grid.Row="5" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                            <TextBox x:Name="NoteTextBox"
                                             Grid.Row="5" Grid.Column="1" Width="200"
                                             TextWrapping="Wrap"
                                             AcceptsReturn="True"
                                             VerticalScrollBarVisibility="Auto"
                                            Height="80"
                                             Margin="0,5"/>

                            <TextBlock Text="Supplier:" Grid.Row="6" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                             <ComboBox x:Name="SupplierComboBox" Grid.Row="6" Grid.Column="1" Width="200" Margin="0,5" 
                                       DisplayMemberPath="Name"
                                        SelectedValuePath="SupplierId"/>

                    </Grid>

                        <!-- Buttons -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                            <Button Content="Save" Width="100" Margin="5" Click="SaveButton_Click"/>
                            <Button Content="Cancel" Width="100" Margin="5" Click="CancelButton_Click"/>
                        </StackPanel>
                    </Grid>
                </Border>
        </Popup>
    </Grid>
</UserControl>
